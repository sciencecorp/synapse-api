syntax = "proto3";

package synapse;

import "google/protobuf/empty.proto";
import "api/node.proto";

enum StatusCode {
  kOk = 0;
  kUndefinedError = 1;
}

enum DeviceState {
  kUnknown = 0;
  kInitializing = 1;
  kStopped = 2;
  kRunning = 3;
  kError = 4;
}

message Status {
  string message = 1;
  StatusCode code = 2;
  DeviceState state = 3;
  repeated NodeSocket sockets = 4;
  uint32 battery_level = 5;
  bool is_charging = 6;
}

message Peripheral {
  string name = 1;
  string vendor = 2;
  uint32 peripheral_id = 3;
  NodeOptions options = 4;
}

message DeviceInfo {
  string name = 1;
  string serial = 2;
  uint32 synapse_version = 3;
  uint32 firmware_version = 4;
  Status status = 5;
  repeated Peripheral peripherals = 6;
  DeviceConfiguration configuration = 7;
}

message DeviceConfiguration {
  repeated NodeConfig nodes = 1;
  repeated NodeConnection connections = 2;
}

service SynapseDevice {
  rpc Info(google.protobuf.Empty) returns (DeviceInfo) {}
  rpc Configure(DeviceConfiguration) returns (Status) {}
  rpc Start(google.protobuf.Empty) returns (Status) {}
  rpc Stop(google.protobuf.Empty) returns (Status) {}
}